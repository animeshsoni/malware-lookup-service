# Malware URL lookup service

## Introduction

Malware URL lookup service is a web service built using python Flask. This service maintains a record of URLs known to contain malware. 
Users can make calls to this service to get information about whether a certain url is safe to access or not. 

## API

| HTTP Method | Action                                                | URI                                                           |
| ----------- | ----------------------------------------------------  | -----------                                                   |
| GET         | Obtain information about a URL - safe or unsafe       | http://{hostname}/v1/urlinfo/{resource_url_with_query_string} |
| POST        | Add new url to list of URLs known to contain malware  | http://{hostname}/v1/urlinfo                                  |


* {resource_url_with_query_string} should be a valid url
* POST calls should contain a json request object with a valid url. 
* A valid url should contain scheme and domain. Subdirectory and query strings are optional.
* URLs are evaluated using only top level and second level domain. http://www.sample.testurl.com/path/query will be evaluated and stored as testurl.com. If testurl.com exists in db, then something like https://prod.testurl.com/differentPath/validQuery will also be considered malicious.

## Responses

Possible values in response body:

1. GET

    - {"response": "safe"}
    - {"response": "unsafe"}
    - {"error": "Cannot parse url. Invalid format."}
    - {"error": "Internal database error"}


2. POST

    - {"response": "success"}
    - {"error": "Cannot parse url. Invalid format."}
    - {"error": "Internal database error"}


## Example Usage (using curl)

1. GET   
        
        curl -u user:pass -i 'https://malware-lookup-service.azurewebsites.net/v1/urlinfo/https://www.sample.testurl.com/path/query'


2. POST 

        curl -u user:pass -X POST -i 'https://malware-lookup-service.azurewebsites.net/v1/urlinfo' -H "Content-Type: application/json" -d '{"url": "https://www.sample.testurl.com/path/query"}'


## Running the service

### This web service is hosted on Microsoft Azure. So you don't need to run the service locally to try it out. 

You can send API calls to https://malware-lookup-service.azurewebsites.net/v1/urlinfo using username 'default' and password 'someComplexPassword'. The DB doesn't contain real malware data, just test data to experiment with. 

### For running your service locally on a linux based machine, follow the instuctions below:

1. Install unzip utility, if not already installed

        sudo apt-get install unzip

2. Download the source code for this repository

        wget https://github.com/animeshsoni/malware-lookup-service/archive/refs/heads/main.zip

3. Unzip the source code and remove zip file

        unzip main.zip && rm main.zip

4. Go to the source code folder

        cd malware-lookup-service-main

5. Execute run.sh script to run the app

        ./run.sh

6. Execute test.sh script to run the unit tests

        ./test.sh 
