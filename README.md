# Malware URL lookup service

## Introduction

Malware URL lookup service is a web service built using python Flask. This service maintains a record of URLs known to contain malware. 
Users can make calls to this service to get information about whether a certain url is safe to access or not. 

## API

| HTTP Method | Action                                                | URI                                                           |
| ----------- | ----------------------------------------------------  | -----------                                                   |
| GET         | Obtain information about a URL - safe or unsafe       | http://{hostname}/v1/urlinfo/{resource_url_with_query_string} |
| POST        | Add new url to list of URLs known to contain malware  | http://{hostname}/v1/urlinfo                                  |


* {resource_url_with_query_string} should be a valid url
* POST calls should contain a json request object with a valid url. 
* A valid url should contain scheme and domain. Subdirectory and query strings are optional.
* URLs are evaluated using only top level and second level domain. http://www.sample.testurl.com/path/query will be evaluated and stored as testurl.com. If testurl.com exists in db, then something like https://prod.testurl.com/differentPath/validQuery will also be considered malicious.

## Responses

Possible values in response body:

1. GET

    - {"response": "safe"}
    - {"response": "unsafe"}
    - {"error": "Cannot parse url. Invalid format."}
    - {"error": "Internal database error"}


2. POST

    - {"response": "success"}
    - {"error": "Cannot parse url. Invalid format."}
    - {"error": "Internal database error"}


## Example Usage (using curl)

1. GET   
        
        curl -u user:pass -i 'http://localhost:5000/v1/urlinfo/https://www.sample.testurl.com/path/query'


2. POST 

        curl -u user:pass -X POST -i 'http://localhost:5000/v1/urlinfo' -H "Content-Type: application/json" -d '{"url": "https://www.sample.testurl.com/path/query"}'


## Running the service

TODO